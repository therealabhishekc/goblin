version: 1.0
runtime: python311

build:
  commands:
    build:
      - echo "Starting build process"
      - pwd
      - ls -la
      - python3 --version
      - python3 -m pip install --upgrade pip
      - python3 -m pip install --no-cache-dir -r requirements.txt
      - echo "Verifying gunicorn installation:"
      - python3 -m pip show gunicorn
      - echo "Testing gunicorn command:"
      - python3 -m gunicorn --version
      - echo "Installed packages:"
      - python3 -m pip list

run:
  command: python3 -m gunicorn app.main:app -w 2 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000 --timeout 120 --log-level info
  network:
    port: 8000
    env: PORT
  env:
    - name: WHATSAPP_TOKEN
      value: EAAI0TVNv9lwBPRve8mxF7KxvIZBD3y3YPZCqErOlrs5T5j2fn7xFZA8PIsufqiWKqXsvFDsqEy2kPChEu5QbLY564Hq7R3npLNW9gRUTbXA7pSKZCDDuyZAMQ55rWTNE2nSEVQNMJ5ZA9JrFOyB6moGzYihjHELzah3oSBtkrNRH6XkElLRnuJFx1rbNHbvUDHs2JzGxhlBVcKVQZCNr3MXvUyRwIErZAVtw4clhvvAOlm6uKQZDZD
    - name: VERIFY_TOKEN
      value: goblinhut
    - name: PHONE_NUMBER_ID
      value: "690297360830875"
    - name: REDISCLOUD_URL
      value: redis://default:GbwiAodvyys0ddq7re9VxLituXKsMh8X@redis-16553.c81.us-east-1-2.ec2.redns.redis-cloud.com:16553
